INSERT INTO
ZOMATO_ETL.DBO.Restaurant_Data_Mapping_Table(RESTAURANT_ID,RESTAURANT_AVERAGE_COST_FOR_TWO,RESTAURANT_CUISINE_ID,RESTAURANT_CURRENCY_ID,RESTAURANT_LOCATION_ID,HAS_ONLINE_DELIVERY,HAS_TABLE_BOOKING,RESTAURANT_RATING_ID,RESTAURANT_EVENT_ID,IS_ACTIVE,CREATED_BY,CREATED_DATE)
SELECT t.RESTAURANT_ID,t.RESTAURANT_AVERAGE_COST_FOR_TWO,t.RESTAURANT_CUISINE_ID,t.RESTAURANT_CURRENCY_ID,t.RESTAURANT_LOCATION_ID,t.HAS_ONLINE_DELIVERY,t.HAS_TABLE_BOOKING,t.RESTAURANT_RATING_ID,t.RESTAURANT_EVENT_ID,t.IS_ACTIVE,t.CREATED_BY,t.CREATED_DATE FROM TABLE(sp_getlkptrsfmddata()) t
LEFT JOIN ZOMATO_ETL.DBO.Restaurant_Data_Mapping_Table r
ON t.RESTAURANT_ID = r.restaurant_id
AND COALESCE(t.RESTAURANT_CUISINE_ID,0) = COALESCE(R.RESTAURANT_CUISINE_ID,0)
AND T.RESTAURANT_CURRENCY_ID = R.RESTAURANT_CURRENCY_ID
AND T.RESTAURANT_LOCATION_ID = R.RESTAURANT_LOCATION_ID
AND t.RESTAURANT_RATING_ID = R.RESTAURANT_RATING_ID
AND COALESCE(T.RESTAURANT_EVENT_ID,0) = COALESCE(R.RESTAURANT_EVENT_ID,0)s
-- AND T.IS_ACTIVE = TRUE 
AND R.IS_ACTIVE = TRUE
WHERE R.RESTAURANT_ID IS NULL