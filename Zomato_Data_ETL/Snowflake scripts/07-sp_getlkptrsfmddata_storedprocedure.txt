CREATE OR REPLACE PROCEDURE sp_getlkptrsfmddata()
RETURNS TABLE(RESTAURANT_ID INT,RESTAURANT_AVERAGE_COST_FOR_TWO INT,RESTAURANT_CUISINE_ID INT,RESTAURANT_CURRENCY_ID INT,RESTAURANT_LOCATION_ID INT,HAS_ONLINE_DELIVERY BOOLEAN,HAS_TABLE_BOOKING BOOLEAN,RESTAURANT_RATING_ID INT,RESTAURANT_EVENT_ID INT,IS_ACTIVE BOOLEAN,CREATED_BY STRING,CREATED_DATE DATETIME)
LANGUAGE SQL
AS
$$
    DECLARE RES RESULTSET;
BEGIN
    RES := (SELECT RESTAURANT_ID,RESTAURANT_AVERAGE_COST_FOR_TWO,RESTAURANT_CUISINE_ID,RESTAURANT_CURRENCY_ID,RESTAURANT_LOCATION_ID,HAS_ONLINE_DELIVERY,HAS_TABLE_BOOKING,RESTAURANT_RATING_ID,RESTAURANT_EVENT_ID,IS_ACTIVE,CREATED_BY,CREATED_DATE 
    FROM ZOMATO_ETL.STAGE.Restaurant_Data_Mapping_Table_Transformed); 
    RETURN TABLE(RES);
END;
$$;

CALL sp_getlkptrsfmddata();